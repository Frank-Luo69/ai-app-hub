(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{8209:function(e,t,n){Promise.resolve().then(n.bind(n,1403))},1403:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return l}});var r=n(7437),a=n(2265),s=n(1180);function l(){let[e,t]=(0,a.useState)(""),[n,l]=(0,a.useState)(!1),[o,i]=(0,a.useState)(""),[u,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null);async function p(){c(!0),m(null);let{error:t}=await s.O.auth.signInWithOtp({email:e,options:{shouldCreateUser:!0,emailRedirectTo:window.location.origin}});c(!1),t?m(t.message):l(!0)}async function h(){c(!0),m(null);let{error:t}=await s.O.auth.verifyOtp({email:e,token:o,type:"email"});c(!1),t?m(t.message):window.location.href="/"}return(0,r.jsxs)("div",{className:"max-w-md mx-auto card space-y-3",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:"登录"}),(0,r.jsx)("input",{type:"email",placeholder:"邮箱",className:"w-full border rounded-xl px-3 py-2",value:e,onChange:e=>t(e.target.value)}),n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"输入 6 位验证码",className:"w-full border rounded-xl px-3 py-2 tracking-widest text-center",value:o,onChange:e=>i(e.target.value)}),(0,r.jsx)("button",{className:"btn-primary px-4 py-2 rounded-xl",onClick:h,disabled:u||o.length<6,children:"验证并登录"}),(0,r.jsx)("button",{className:"btn",onClick:p,disabled:u,children:"重发验证码"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"btn-primary px-4 py-2 rounded-xl",onClick:p,disabled:u||!e,children:"发送登录验证码到邮箱"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"邮件里也会附带“登录链接”；点链接在哪个设备打开，就会在哪个设备登录。"})]}),d&&(0,r.jsx)("div",{className:"text-sm text-red-600",children:d})]})}},1180:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(4593),a=n(357);let s=a.env.NEXT_PUBLIC_SUPABASE_URL,l=a.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,o=s&&l?(0,r.eI)(s,l):function(){let e=()=>{};return{from(e){let t={table:e,filter:{}},n={select:()=>n,eq:(e,r)=>(t.filter[e]=r,n),order:()=>Promise.resolve({data:[],error:null}),single:()=>"apps"===t.table&&"e2e-demo"===t.filter.slug?Promise.resolve({data:{id:"e2e-app-1",title:"E2E Demo App",slug:"e2e-demo",description:"Mock app for e2e without backend",cover_url:null,play_url:"https://example.com",source_host:"example.com",tags:["demo"],status:"active",owner_id:"owner-1",created_at:new Date().toISOString()},error:null}):Promise.resolve({data:null,error:{message:"not found (mock)"}}),insert:()=>Promise.resolve({data:null,error:{message:"unauthenticated (mock)"}}),update:()=>Promise.resolve({data:null,error:{message:"unauthenticated (mock)"}}),delete:()=>Promise.resolve({error:{message:"unauthenticated (mock)"}})};return n},rpc:async()=>({data:!1,error:null}),auth:{getUser:async()=>({data:{user:null},error:null}),getSession:async()=>({data:{session:null},error:null}),onAuthStateChange:(t,n)=>({subscription:{unsubscribe:e}}),signOut:async()=>({error:null})},channel:()=>({on:()=>({subscribe:()=>({})})}),removeChannel:e}}()}},function(e){e.O(0,[816,971,23,744],function(){return e(e.s=8209)}),_N_E=e.O()}]);