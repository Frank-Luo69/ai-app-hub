(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[235],{8209:function(e,n,t){Promise.resolve().then(t.bind(t,1403))},1403:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return l}});var r=t(7437),s=t(2265),a=t(1180);function l(){let[e,n]=(0,s.useState)(""),[t,l]=(0,s.useState)(!1),[o,u]=(0,s.useState)(""),[i,c]=(0,s.useState)(!1),[d,m]=(0,s.useState)(null);async function h(){c(!0),m(null);let{error:n}=await a.O.auth.signInWithOtp({email:e,options:{shouldCreateUser:!0,emailRedirectTo:window.location.origin}});c(!1),n?m(n.message):l(!0)}async function x(){c(!0),m(null);let{error:n}=await a.O.auth.verifyOtp({email:e,token:o,type:"email"});c(!1),n?m(n.message):window.location.href="/"}return(0,r.jsxs)("div",{className:"max-w-md mx-auto card space-y-3",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:"登录"}),(0,r.jsx)("input",{type:"email",placeholder:"邮箱",className:"w-full border rounded-xl px-3 py-2",value:e,onChange:e=>n(e.target.value)}),t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"输入 6 位验证码",className:"w-full border rounded-xl px-3 py-2 tracking-widest text-center",value:o,onChange:e=>u(e.target.value)}),(0,r.jsx)("button",{className:"btn-primary px-4 py-2 rounded-xl",onClick:x,disabled:i||o.length<6,children:"验证并登录"}),(0,r.jsx)("button",{className:"btn",onClick:h,disabled:i,children:"重发验证码"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"btn-primary px-4 py-2 rounded-xl",onClick:h,disabled:i||!e,children:"发送登录验证码到邮箱"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"邮件里也会附带“登录链接”；点链接在哪个设备打开，就会在哪个设备登录。"})]}),d&&(0,r.jsx)("div",{className:"text-sm text-red-600",children:d})]})}},1180:function(e,n,t){"use strict";t.d(n,{O:function(){return o}});var r=t(4593),s=t(357);let a=s.env.NEXT_PUBLIC_SUPABASE_URL,l=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,o=a&&l?(0,r.eI)(a,l):function(){let e=()=>{};return{from(){let e={select:()=>e,eq:()=>e,order:()=>Promise.resolve({data:[],error:null}),single:()=>Promise.resolve({data:null,error:{message:"not found (mock)"}}),insert:()=>Promise.resolve({data:null,error:{message:"unauthenticated (mock)"}}),update:()=>Promise.resolve({data:null,error:{message:"unauthenticated (mock)"}}),delete:()=>Promise.resolve({error:{message:"unauthenticated (mock)"}})};return e},rpc:async()=>({data:!1,error:null}),auth:{getUser:async()=>({data:{user:null},error:null}),getSession:async()=>({data:{session:null},error:null}),onAuthStateChange:(n,t)=>({subscription:{unsubscribe:e}}),signOut:async()=>({error:null})},channel:()=>({on:()=>({subscribe:()=>({})})}),removeChannel:e}}()}},function(e){e.O(0,[816,971,23,744],function(){return e(e.s=8209)}),_N_E=e.O()}]);